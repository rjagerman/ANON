\documentclass[journal]{IEEEtran}

% Some very useful LaTeX packages include:
% (uncomment the ones you want to load, see original template for descriptions)
%\usepackage{ifpdf}
%\usepackage{cite}
%\usepackage[cmex10]{amsmath}
%\usepackage{algorithmic}
%\usepackage{array}
%\usepackage{fixltx2e}
%\usepackage{stfloats}
%\usepackage{dblfloatfix}
%\usepackage{url}

% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

% *** UTF8 ***
\usepackage[utf8]{inputenc}


\begin{document}

	% Title of the paper
	\title{ANON paper}
	% Authors
	\author{Rolf Jagerman, Wendo Sab\'ee, Laurens Versluis, Martijn de Vos}

	% The paper headers
	%\markboth{Journal of \LaTeX\ Class Files,~Vol.~11, No.~4, December~2012}%
	%{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}
	% The only time the second header will appear is for the odd numbered pages
	% after the title page when using the twoside option.

	% make the title area
	\maketitle

	% As a general rule, do not put math, special symbols or citations
	% in the abstract or keywords.
	\begin{abstract}
		The abstract goes here. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc et elit nec metus ultrices faucibus. Mauris volutpat libero eu arcu sodales, ac bibendum neque pulvinar. Sed et ipsum nunc. Quisque ac sem ut nunc tincidunt commodo. Cras at odio nibh. Pellentesque sodales ut tortor sed dictum. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. 
	\end{abstract}


	\section{Introduction}
		% The very first letter is a 2 line initial drop letter followed
		% by the rest of the first word in caps.
		% 
		% form to use if the first word consists of a single letter:
		% \IEEEPARstart{A}{demo} file is ....
		% 
		% form to use if you need the single drop letter followed by
		% normal text (unknown if ever used by IEEE):
		% \IEEEPARstart{A}{}demo file is ....
		% 
		% Some journals put the first two words in caps:
		% \IEEEPARstart{T}{his demo} file is ....
		% 
		% Here we have the typical use of a "T" for an initial drop letter
		% and "HIS" in caps to complete the first word.
		% You must have at least 2 lines in the paragraph with the drop letter
		% (should never be an issue)
		\IEEEPARstart{L}{orem} ipsum dolor sit amet, consectetur adipiscing elit. Nunc et elit nec metus ultrices faucibus. Mauris volutpat libero eu arcu sodales, ac bibendum neque pulvinar. Sed et ipsum nunc. Quisque ac sem ut nunc tincidunt commodo. Cras at odio nibh. Pellentesque sodales ut tortor sed dictum. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.
		
		
	\section{Tor design}
		\label{sec:tor}
		The implementation of The Onion Router was first described by the U.S. Navy Research Laboratory, as means to protect government communications from digital, as well as physical attacks, by hiding the location of the communicating party or parties \cite{bib:goldschlag}.
		
		In 2002, it was decided to ditch the old code base and reimplement the project as Tor, the Second Generation Onion Router, introducing perfect forward secrecy, directory servers, hidden services and more \cite{bib:dingledine}.
		
		\subsection{Onion routing}
			As described in the original design paper of The Onion Router, network traffic is forwarded through a circuit of nodes, where each node only knows the previous and next node in the circuit. With a sufficiently long circuit of (independent) nodes, this means that two communicating parties can remain oblivious of each others physical location.
			
			Say we have a circuit of nodes $C = \{c_0, \dots, c_n\}$, where $c_0$ is our trusted client and $c_n$ is the exit node. Each node has its own public key $p$ and a corresponding private key $d$. For each node in $C$, $c_0$ generates a distinct secret $s$.
			
			The payload of each packet flowing from $c_0$ to $c_n$ through circuit $C$ is first encrypted with $s_e$, the secret generated for node $c_e$. This is repeated for $s_{e-1}$, $s_{e-2}$, etc, until lastly it is encrypted with $s_1$. With each layer of encryption, a header is added with the address of next node in the circuit, plus the generated secret $s$ for the current node, encrypted its public key.
			
			After node $c_1$ receives this packet from our trusted node $c_0$, it decrypts the secret $s_1$ with its private key $d_1$, and uses it to decrypt the rest of the packet. The result is a header with the address of node $c_2$ and the payload encrypted with secrets $s_2$ to $s_e$, which is forwarded to node $c_2$.
			
			As node $c_x$ receives data from the previous node $c_{x-1}$, it peels off another layer of encryption, much as how you can peel an onion layer for layer, and forwards it to $c_{x+1}$. When exit node $c_n$ decrypts the last layer and forwards the unencrypted payload outside the network to the original destination that $c_0$ specified, acting as a traditional proxy. 
			
			When $c_n$ receives a response, this whole process is applied in reverse order, encrypting the payload with its secret along the way, instead of decrypting. When $c_0$ receives the packet, it peels off all the encryption layers to retrieve the unencrypted payload. 
			
			With the second generation onion routing used in Tor, a modified algorithm is used to derive the encryption keys, called \emph{telescoping path-building}, which also provides perfect forward secrecy. This algorithm is described in section \ref{ss:tor_circuit}.
			
			
		\subsection{Directory servers}
			The original Onion Router implementation used in-band status updates where each node broadcasts know nodes to its neighbours. An attacker could exploit this to isolate and limit the knowledge of a client, forcing connections through malicious nodes. Beside possible security disadvantages, in-band status updates also have the disadvantage that it takes longer to propagate throughout the network and create a global consensus.
			
			To mitigate these concerns, Directory Servers were introduced to Tor during its reimplementation to keep a redundant central consensus about the network. They act as HTTP servers to which Tor nodes can publish signed information about themselves. Tor clients can in turn download this information.
			
			This information is signed by the Directory Servers before it is distributed to the Tor clients. The keys to verify these signatures are preloaded in the Tor software, along with the list of Directory Servers, which implies trust by the Tor client in the Directory Servers.
			
			
		\subsection{Relay and exit nodes}
			[gebruikt: the second generation onion router]
			The Tor network consists of several components. The clients in the Tor network are known as Onion Proxies. The software to run an Onion Proxy is available for free on the Tor website [linkje] and is easy to configure. The Onion Proxies are responsible for downloading the directory information, establish circuits across the network and handle connections from user applications.\\\\
			The routing in the network is done by Onion Routers, also called relay nodes. The relay nodes relays the data from the Onion Proxy to the webserver across a circuit (circuits are described in 2D). Each Onion Router is connected to every other Onion Router with a TLS connection [link naar TLS protocol]. Each circuit has three type of Onion Routers [link naar download.pdf]:
			\begin{itemize}
				\item The entrance Tor router: this is the router that is directly connected to an Onion Proxy and can observe the origin of a request through the Tor network. The entrance router sends the packet to the middle Tor router.
				\item The middle Tor router: this router is connected to the entrance router and the exit router.
				\item The exit Tor router: this router is connected to the webserver. Note that the exit Tor router is the only router that can observe the final destination of the request.
			\end{itemize}
			The first router in a circuit is the entrance router. The entrance router sends the data to one of the middle router which forwards the data to the exit router.
		
		\subsection{Circuit creation}
			\label{ss:tor_circuit}
			As described in the previous section, data on the Tor networks travels over circuits. The data travels over the circuit in fixed-size cells that are 512 bytes long. Each cell has a header and a payload. The header consists of a number that identifies the circuit of the cell and a command that indicates what to do with the cellâ€™s payload.\\\\
			Before a circuit can be established, a path has to be chosen. The current path selection algorithm in Tor selects nodes based on the bandwidth of the nodes [link naar cacr2011-20]. Nodes that have more bandwidth, have a higher probability to be chosen for the circuit setup, however, the same node can't be used more than once in a circuit.\\\\
			Suppose Alice is an Onion Proxy that wants to connect through the Tor network to a webserver. Circuit setup uses the Diffie-Hellman key-exchange protocol [linkje] to establish a shared secret between nodes. To create a new circuit, Alice first sends a \emph{create} cell with the first half of the Diffie-Hellman handshake ($ g^b $) to the first node in her selected path (for example, OR1). OR1 sends a \emph{created} cell back with the second half of the key ($ g^b $) along with a hash of the final key. Now both Alice and OR1 have a shared key they use to encrypt and decrypt data between them.\\\\
			So now Alice has a connection with the first Onion Router in the circuit. To extend the circuit to OR2, Alice first sends a \emph{relay extend} cell to OR1. This cell contains the address of the next Onion Router in the circuit and the first half of the key to use in the communication between her and OR2 ($ g^{a_2} $). OR1 takes this first half of the key and sends a \emph{create} cell with this key to OR2. When OR1 receives a created cell, OR1 passes this cell to Alice. Now Alice and OR2 share a common key: $ K = g^{a_2b_2} $. The same procedure can be used to extend the circuit with more nodes.
		
		\subsection{Disadvantages}
			While Tor guaranteers anonimity, there are some disadvantages using it. The main disadvantage is that the Tor network is slow. According to the Tor Metrics project [link naar tor metrics project], it takes about 6 seconds to download 1 MiB of data.\\\\
			According to Dingleding et al [link naar 2009-03-11-performance.pdf], there are six reasons why Tor is not optimal. In this section, we will summarize these reasons and explain what could be done to fix them.\\\\
			First of all, the congestion control does not work well. The network has some problems handling bulk transfers, such as when downloading large files or streaming high-quality videos. The congestion control could be improved by using an unreliable protocol for links between Tor relays.\\\\
			Some Tor users put more traffic on the network than they contribute by running a Onion Router. This means that these users are slowing the network down as they use more traffic than giving to the network. A possible solution for this is to throttle certain protocols at exit nodes or at Onion Proxies.\\\\
			Also, the Tor network doesn't have the capacity to handle all the users that want privacy on the Internet. By increasing the amount of Onion Routing in the Tor network, the capacity is increased. Incentives such as LIRA [link naar lira paper] could make more users run a Onion Router, thus increasing the capacity of the network.\\\\
			The current path selection algorithm of Tor doesn't distribute the load evenly over the network. The problem is that the current selection strategy is optimal when the network is fully loaded. Using a better path selection algorithm could increase the capacity of the network and the overall user experience.\\\\
			Another problem is that the Tor clients are not optimal at handling latency and connection failures. For example, if extending a circuit fails, the entire circuit is abandoned. An improvement would be to first try to extend the circuit to some other places. If that fails, the circuit could be abandoned. Also, a better timeout mechanism could be chosen for building circuits.\\\\
			Much of the overhead of the network is in downloading the directory information. There is also overhead in the TLS connection between the nodes in the network. Removing the empty TLS application record which could reduce the overhead in the TCP/IP header with 6.3\% [citaat].
		
	\section{Conclusion}
		The conclusion goes here.
		
		
	\appendices
%		\section{Proof of the First Zonklar Equation}
%			Appendix one text goes here.
			
			% you can choose not to have a title for an appendix
			% if you want by leaving the argument blank
%		\section{}
%			Appendix two text goes here.
			
			
		% use section* for acknowledgement
%		\section*{Acknowledgment}
%			The authors would like to thank...
			
			
		% Can use something like this to put references on a page
		% by themselves when using endfloat and the captionsoff option.
%		\ifCLASSOPTIONcaptionsoff
%		  \newpage
%		\fi
			
		% trigger a \newpage just before the given reference
		% number - used to balance the columns on the last page
		% adjust value as needed - may need to be readjusted if
		% the document is modified later
		%\IEEEtriggeratref{8}
		% The "triggered" command can be changed if desired:
		%\IEEEtriggercmd{\enlargethispage{-5in}}
		
		% references section
		
		% can use a bibliography generated by BibTeX as a .bbl file
		% BibTeX documentation can be easily obtained at:
		% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
		% The IEEEtran BibTeX style support page is at:
		% http://www.michaelshell.org/tex/ieeetran/bibtex/
		%\bibliographystyle{IEEEtran}
		% argument is your BibTeX string definitions and bibliography database(s)
		%\bibliography{IEEEabrv,../bib/paper}
		%
		% <OR> manually copy in the resultant .bbl file
		% set second argument of \begin to the number of references
		% (used to reserve space for the reference number labels box)
	\begin{thebibliography}{1}

		\bibitem{bib:goldschlag}
			David M. Goldschlag, Michael G. Reed, and Paul F. Syverson. "Hiding Routing Information", Workshop on Information Hiding, Cambridge, UK, May, 1996.
		
		\bibitem{bib:dingledine}
			Roger Dingledine, Nick Mathewson, Paul Syverson. "Tor: The Second-Generation Onion Router", 2002.
		
	\end{thebibliography}

\end{document}


